<div class="table-container">
    <table>
        <thead>
            <tr>
                ${data[0].reduce((acc, cell) => {
                    switch(cell.type) {
                        case cellTypes.HEADER:
                            return acc + `<th class="sticky"><div class="rotated">${cell.value}</div></th>`;
                        case cellTypes.EMPTY:
                            return acc + `<th class="sticky"></th>`;
                        default:
                            return acc + `<th class="sticky"><div class="rotated">${cell.value}</div></th>`;
                    }
                }, '')}
            </tr>
        </thead>
        <tbody>
            ${data.slice(1).reduce((trAcc, row, rowIndex) => {
                return trAcc + `<tr>${
                    row.reduce((tdAcc, cell, colIndex) => {
                        switch(cell.type) {
                            case cellTypes.HEADER:
                                return tdAcc + `<td class="sticky"><div class="flex"><div class="row-index">${cell.index}</div><div class="row-label">${cell.value}</div></div></td>`;
                            
                            case cellTypes.REPORT:
                                return tdAcc + `<td style="background-color: ${cell.color};">${cell.value}</td>`;
                            
                            case cellTypes.VALUE:
                                return tdAcc + `<td class="editable-cell" data-item-id="${cell.item_id || ''}">${cell.value}</td>`;
                            
                            case cellTypes.EMPTY:
                                return tdAcc + `<td></td>`;
                            
                            default:
                                return tdAcc + `<td>${cell.value}</td>`;
                        }
                    }, '')
                }</tr>`;
            }, '')}
        </tbody>
    </table>
</div>
<button class="export-button">Export</button>